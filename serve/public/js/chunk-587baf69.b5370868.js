(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-587baf69"],{"05c3":function(e,t,n){"use strict";var i=n("93f9"),a=n.n(i);a.a},"6c78":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"blog-add"},[n("div",{staticClass:"title-nav"},[n("button",{staticClass:"back",on:{click:function(t){return t.stopPropagation(),e.$router.go(-1)}}},[e._v("返回")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.blog.title,expression:"blog.title"}],attrs:{type:"text",placeholder:"请输入标题!"},domProps:{value:e.blog.title},on:{input:function(t){t.target.composing||e.$set(e.blog,"title",t.target.value)}}}),n("button",{directives:[{name:"show",rawName:"v-show",value:"add"===e.type,expression:"type === 'add'"}],staticClass:"save",on:{click:function(t){return t.stopPropagation(),e.handleSave(t)}}},[e._v(" 保存草稿 ")]),n("button",{staticClass:"public",on:{click:function(t){t.stopPropagation(),e.dialogFormVisible=!0}}},[e._v(" "+e._s("add"===e.type?"发布文章":"保存修改")+" ")])]),n("p",{directives:[{name:"show",rawName:"v-show",value:e.showTips,expression:"showTips"}],staticClass:"img-tips"},[e._v(" 图片的大小可以通过query参数w,h指定大小(imgURL?w=100&h=100) "),n("span",{staticClass:"iconfont icon-xianshi_quxiaotianchong",on:{click:function(t){return t.stopPropagation(),e.hideTips(t)}}})]),n("div",{staticClass:"edit"},[n("mavon-editor",{ref:"addBlogInput",staticClass:"edit-main",attrs:{imageFilter:e.imageFilter,codeStyle:"atelier-plateau-light"},on:{imgAdd:e.imgAdd,imgDel:e.imgDel,change:e.handleChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),n("el-dialog",{attrs:{title:"发布文章",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("p",[e._v(" 添加标签 : "),e._l(e.blog.articleTags,(function(t){return n("el-tag",{key:t,attrs:{closable:"","disable-transitions":!1},on:{close:function(n){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),e.inputVisible?n("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 添加标签")])],2),n("p",[e._v(" 分类专栏 : "),n("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择分类"},model:{value:e.blog.types,callback:function(t){e.$set(e.blog,"types",t)},expression:"blog.types"}},e._l(e.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("p",[e._v(" 发布形式 : "),n("el-checkbox",{model:{value:e.blog.privated,callback:function(t){e.$set(e.blog,"privated",t)},expression:"blog.privated"}},[e._v("私有")])],1),n("p",{staticClass:"control"},[n("button",{staticClass:"save cancel",on:{click:function(t){t.stopPropagation(),e.dialogFormVisible=!1}}},[e._v(" 取消 ")]),n("button",{staticClass:"save comfirm",on:{click:function(t){return t.stopPropagation(),e.handlePublic(t)}}},[e._v(" 确认 ")])])])],1)},a=[],s=(n("c975"),n("d81d"),n("a434"),n("b0c0"),n("ac1f"),n("5319"),n("96cf"),n("1da1")),o={data:function(){return{blog:{privated:!1,title:"",markdown:"",types:[],articleTags:["js"],html:"",_id:void 0},tags:[],value:"",type:"add",dialogFormVisible:!1,inputVisible:!1,inputValue:"",remoteTypes:[],showTips:!1}},computed:{options:function(){return this.remoteTypes.map((function(e){return{value:e.name,label:e.name}}))}},created:function(){var e=this.$route.query,t=e.id,n=e.type;t&&"edit"===n?(this.type="edit",this.getBlogById(t)):(this.value="",this.$message({message:"当前为发布模式!",showClose:!0,type:"success"})),this.getBlogTypes()},methods:{hideTips:function(){this.showTips=!1},getBlogTypes:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("getBlogTypes");case 2:n=t.sent,e.remoteTypes=n||[];case 4:case"end":return t.stop()}}),t)})))()},handleChange:function(e,t){this.blog.markdown=e,this.blog.html=t},handleSave:function(){console.log(this.blog)},handlePublic:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(e.blog),n=null,"add"!==e.type){t.next=8;break}return t.next=5,e.$store.dispatch("AddBlog",{context:e.blog,tags:e.tags});case 5:n=t.sent,t.next=12;break;case 8:if("edit"!==e.type){t.next=12;break}return t.next=11,e.$store.dispatch("editBlog",{context:e.blog,tags:e.tags});case 11:n=t.sent;case 12:n&&(e.$message({message:"发布成功",showClose:!0,type:"success"}),e.$router.replace("/show-blog/"+n._id));case 13:case"end":return t.stop()}}),t)})))()},getBlogById:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("getBlogById",e);case 2:i=n.sent,t.blog=i,t.value=i.markdown,t.tags=i.thumbnails;case 6:case"end":return n.stop()}}),n)})))()},handleClose:function(e){this.blog.articleTags.splice(this.blog.articleTags.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var e=this.inputValue;e&&this.blog.articleTags.push(e),this.inputVisible=!1,this.inputValue=""},imgAdd:function(e,t){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function i(){var a,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a=new FormData,a.append("image",t),i.next=4,n.$store.dispatch("blogAddIMG",a);case 4:s=i.sent,n.tags.push(s),n.$refs.addBlogInput.$img2Url(e,s.src),n.showTips=!0;case 8:case"end":return i.stop()}}),i)})))()},imageFilter:function(e){return!0},imgDel:function(e){console.log(e)}}},l=o,r=(n("05c3"),n("2877")),c=Object(r["a"])(l,i,a,!1,null,"d1df900a",null);t["default"]=c.exports},"93f9":function(e,t,n){},c975:function(e,t,n){"use strict";var i=n("23e7"),a=n("4d64").indexOf,s=n("a640"),o=n("ae40"),l=[].indexOf,r=!!l&&1/[1].indexOf(1,-0)<0,c=s("indexOf"),u=o("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:r||!c||!u},{indexOf:function(e){return r?l.apply(this,arguments)||0:a(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-587baf69.b5370868.js.map